@c This is part of the Radius manual.
@c Copyright (C) 1999,2000,2001,2002,2003,2004 Free Software Foundation, Inc.
@c Written by Sergey Poznyakoff
@c See file radius.texi for copying conditions.
@setfilename radius.info

@comment **L3***************************************************************
@node Attribute List, , , Top
@chapter Attribute List

The following sections describe the most frequently used Radius
attributes. Each attribute is described as follows:

@defattr{@var{name},@var{value},@var{type},@var{user-flags},@var{hints-flags},@var{huntgroup-flags},@var{additivity},@var{prop}}

These values have the following meaning:

@table @var
@item name
The attribute name.
@item value
The attribute number.
@item type
The attribute type.
@item user-flags
Syntax flags defining in which part of a @file{raddb/users} entry this
attribute may be used. The flags consist of two letters: @samp{L} means
the attribute can be used in the @LHS{}, @samp{R} means it can be used in
the @RHS{}. 
@item hints-flags
Syntax flags defining in which part of a @file{raddb/hints} entry this
attribute may be used.
@item huntgroup-flags
Syntax flags defining in which part of a @file{raddb/huntgroups} entry this
attribute may be used.
@item additivity
The @dfn{additivity} of the attribute determines what happens if a rule
attempts to add to the pair list an attribute that is already present
in this list. Depending on its value, the actions of the server are:
@table @asis
@item Append
New attribute is appended to the end of the list.
@item Replace
New attribute replaces the old.
@item Drop
New attribute is dropped. The old one remains in the list.
@end table
@item prop
Is the attribute propagated back to the @NAS{} if the server works
in proxy mode?
@end table

The entry @acronym{N/A} for any of this fields signifies ``not
applicable''.


@menu
* Authentication Attributes::
* Accounting Attributes::
* Radius Internal Attributes::
@end menu

@node Authentication Attributes
@section Authentication Attributes

These are the attributes the @NAS{} uses in authentication packets
and expects to get back in authentication replies. These can
be used in matching rules.

@menu
* CHAP-Password:: 
* Callback-Id:: 
* Callback-Number:: 
* Called-Station-Id::
* Calling-Station-Id::
* Class:: 
* Framed-Compression:: 
* Framed-IP-Address:: 
* Framed-IP-Netmask:: 
* Framed-MTU:: 
* Framed-Protocol:: 
* Framed-Route:: 
* Framed-Routing:: 
* Idle-Timeout:: 
* NAS-IP-Address:: 
* NAS-Identifier::
* NAS-Port-Id:: 
* NAS-Port-Type::
* Reply-Message:: 
* Service-Type:: 
* Session-Timeout:: 
* State:: 
* Termination-Action:: 
* User-Name:: 
* User-Password:: 
* Vendor-Specific:: 
@end menu

@comment **************************************************************
@node CHAP-Password
@subsection @attr{CHAP-Password}
@atindex CHAP-Password

@defattr{CHAP-Password,3,string,L-,--,--,@acronym{N/A},No}

This attribute indicates the response value provided by a PPP
Challenge-Handshake Authentication Protocol (CHAP) user in
response to the challenge.  It is only used in Access-Request
packets.

The CHAP challenge value is found in the CHAP-Challenge attribute
(60) if present in the packet, otherwise in the request
authenticator field.

@comment **************************************************************
@node Callback-Id
@subsection @attr{Callback-Id}
@atindex Callback-Id

@defattr{Callback-Id,20,string,-R,--,--,Replace,No}

This attribute indicates the name of a place to be called, to be
interpreted by the @NAS{}.  It may be used in Access-Accept packets.

@comment **************************************************************
@node Callback-Number
@subsection @attr{Callback-Number}
@atindex Callback-Number

@defattr{Callback-Number,19,string,-R,--,--,Replace,No}

This attribute indicates a dialing string to be used for callback.
It may be used in Access-Accept packets.  It may be used in an
Access-Request packet as a hint to the server that a Callback
service is desired, but the server is not required to honor the
hint.

@comment **************************************************************
@node Called-Station-Id
@subsection @attr{Called-Station-Id}
@atindex Called-Station-Id

@defattr{Called-Station-Id,30,string,L-,-R,LR,Append,No}

This attribute allows the @NAS{} to send in the Access-Request packet
the phone number that the user called, using Dialed Number
Identification (DNIS) or similar technology.  Note that this may be
different from the phone number the call comes in on.  It is only
used in Access-Request packets.

@comment **************************************************************
@node Calling-Station-Id
@subsection @attr{Calling-Station-Id}
@atindex Calling-Station-Id

@defattr{Calling-Station-Id,31,string,L-,-R,LR,Append,No}

This attribute allows the @NAS{} to send in the Access-Request packet
the phone number that the call came from, using automatic number
identification (ANI) or similar technology.  It is only used in
Access-Request packets.

@comment **************************************************************
@node Class
@subsection @attr{Class}
@atindex Class

@defattr{Class,25,string,LR,LR,LR,Append,No}

This attribute is available to be sent by the server to the client
in an Access-Accept and should be sent unmodified by the client to
the accounting server as part of the Accounting-Request packet if
accounting is supported.

@comment **************************************************************
@node Framed-Compression
@subsection @attr{Framed-Compression}
@atindex Framed-Compression

@defattr{Framed-Compression,13,integer,LR,-R,LR,Replace,Yes}

@smallexample
VALUE      Framed-Compression  None                 0       
VALUE      Framed-Compression  Van-Jacobson-TCP-IP  1       
@end smallexample

This attribute indicates a compression protocol to be used for the
link.  It may be used in Access-Accept packets.  It may be used in
an Access-Request packet as a hint to the server that the @NAS{}
would prefer to use that compression, but the server is not
required to honor the hint.

More than one compression protocol attribute may be sent.  It is
the responsibility of the @NAS{} to apply the proper compression
protocol to appropriate link traffic.

@comment **************************************************************
@node Framed-IP-Address
@subsection @attr{Framed-IP-Address}
@atindex Framed-IP-Address

@defattr{Framed-IP-Address,8,ipaddr,LR,-R,LR,Replace,No}

This attribute indicates the address to be configured for the
user.  It may be used in Access-Accept packets.  It may be used in
an Access-Request packet as a hint by the @NAS{} to the server that
it would prefer that address, but the server is not required to
honor the hint.

The value @code{0xFFFFFFFF} (@code{255.255.255.255}) indicates that
the NAS should 
allow the user to select an address. The value @code{0xFFFFFFFE}
(@code{255.255.255.254}) 
indicates that the @NAS{} should select an address for the user (e.g. assigned
from a pool of addresses kept by the @NAS{}).  Other valid values indicate
that the @NAS{} should use that value as the user's IP.

When used in a @RHS{}, the value of this attribute can
optionally be followed by a plus sign. This usage means that
the value of @attr{NAS-Port-Id} must be added to this IP before
replying. For example,

@smallexample
        Framed-IP-Address = 10.10.0.1+
@end smallexample

@comment **************************************************************
@node Framed-IP-Netmask
@subsection @attr{Framed-IP-Netmask}
@atindex Framed-IP-Netmask

@defattr{Framed-IP-Netmask,9,ipaddr,LR,-R,LR,Replace,No}

This attribute indicates the IP netmask to be configured for the
user when the user is a router to a network.  It may be used in
Access-Accept packets.  It may be used in an Access-Request packet
as a hint by the @NAS{} to the server that it would prefer that
netmask, but the server is not required to honor the hint.

@comment **************************************************************
@node Framed-MTU
@subsection @attr{Framed-MTU}
@atindex Framed-MTU

@defattr{Framed-MTU,12,integer,LR,-R,-R,Replace,Yes}

This attribute indicates the maximum transmission unit to be
configured for the user, when it is not negotiated by some other
means (such as PPP).  It is only used in Access-Accept packets.

@comment **************************************************************
@node Framed-Protocol
@subsection @attr{Framed-Protocol}
@atindex Framed-Protocol

@defattr{Framed-Protocol,7,integer,LR,-R,LR,Replace,Yes}

@smallexample
VALUE      Framed-Protocol   PPP                  1       
VALUE      Framed-Protocol   SLIP                 2       
@end smallexample

This attribute indicates the framing to be used for framed access.
It may be used in both Access-Request and Access-Accept packets.

@comment **************************************************************
@node Framed-Route
@subsection @attr{Framed-Route}
@atindex Framed-Route

@defattr{Framed-Route,22,string,-R,--,--,Replace,No}

This attribute provides routing information to be configured for
the user on the @NAS{}.  It is used in the Access-Accept packet and
can appear multiple times.

@comment **************************************************************
@node Framed-Routing
@subsection @attr{Framed-Routing}
@atindex Framed-Routing

@defattr{Framed-Routing,10,integer,-R,-R,-R,Replace,No}

@smallexample
VALUE      Framed-Routing    None                 0       
VALUE      Framed-Routing    Broadcast            1       
VALUE      Framed-Routing    Listen               2       
VALUE      Framed-Routing    Broadcast-Listen     3       
@end smallexample

This attribute indicates the routing method for the user when the
user is a router to a network.  It is only used in Access-Accept
packets.

@comment **************************************************************
@node Idle-Timeout
@subsection @attr{Idle-Timeout}
@atindex Idle-Timeout

@defattr{Idle-Timeout,28,integer,-R,--,--,Replace,Yes}

This attribute sets the maximum number of consecutive seconds of
idle connection allowed to the user before termination of the
session or prompt.  The server may send this attribute to the client
in an Access-Accept or Access-Challenge.

@comment **************************************************************
@node NAS-IP-Address
@subsection @attr{NAS-IP-Address}
@atindex NAS-IP-Address

@defattr{NAS-IP-Address,4,ipaddr,L-,-R,LR,Append,No}

This attribute indicates the identifying IP of the @NAS{}
which is requesting authentication of the user.  It is only used
in Access-Request packets. Each Access-Request packet should contain
either a @attr{NAS-IP-Address} or a @attr{NAS-Identifier} attribute
(@ref{NAS-Identifier}).

@comment **************************************************************
@node NAS-Identifier
@subsection @attr{NAS-Identifier}
@atindex NAS-Identifier

@defattr{NAS-Identifier,32,string,L-,-R,LR,Append,No}

This attribute contains a string identifying the @NAS{} originating
the access request.  It is only used in Access-Request packets.
Either @attr{NAS-IP-Address}  or @attr{NAS-Identifier} should be present in an
Access-Request packet.

@xref{NAS-IP-Address}.

@comment **************************************************************
@node NAS-Port-Id
@subsection @attr{NAS-Port-Id}
@atindex NAS-Port-Id

@defattr{NAS-Port-Id,5,integer,LR,-R,LR,Append,No}

This attribute indicates the physical port number of the @NAS{} that
is authenticating the user.  It is only used in Access-Request
packets.  Note that here we are using ``port'' in its sense of a
physical connection on the @NAS{}, not in the sense of a @sc{tcp} or 
@sc{udp} port number.

Some @NAS{}es try to encode various information in the @attr{NAS-Port-Id}
attribute value. For example, the @sc{max a}scend terminal server constructs
@attr{NAS-Port-Id} by concatenating the line type (one digit), the line number
(two digits), and the channel number (two digits), thus producing
a five-digit port number. In order to normalize such encoded
port numbers we recommend using a rewrite function (@pxref{rewrite file}).
A rewrite function for @sc{max a}scend servers is provided in the
distribution.

@comment **************************************************************
@node NAS-Port-Type
@subsection @attr{NAS-Port-Type}
@atindex NAS-Port-Type

@defattr{NAS-Port-Type,61,integer,--,--,--,Append,No}

@smallexample
VALUE      NAS-Port-Type     Async                0       
VALUE      NAS-Port-Type     Sync                 1       
VALUE      NAS-Port-Type     ISDN                 2       
VALUE      NAS-Port-Type     ISDN-V120            3       
VALUE      NAS-Port-Type     ISDN-V110            4       
@end smallexample

This attribute indicates the type of the physical port of the @NAS{}
that is authenticating the user.  It can be used instead of or in
addition to the @attr{NAS-Port-Id} (@ref{NAS-Port-Id}) attribute.  It
is only used in
Access-Request packets.  Either @attr{NAS-Port} or @attr{NAS-Port-Type} or
both should be present in an Access-Request packet, if the @NAS{}
differentiates among its ports.

@comment **************************************************************
@node Reply-Message
@subsection @attr{Reply-Message}
@atindex Reply-Message

@defattr{Reply-Message,18,string,-R,--,--,Append,Yes}

This attribute indicates text that may be displayed to the user.

When used in an Access-Accept, it is the success message.

When used in an Access-Reject, it is the failure message.  It may
indicate a dialog message to prompt the user before another
Access-Request attempt.

When used in an Access-Challenge, it may indicate a dialog message
to prompt the user for a response.

Multiple @attr{Reply-Message} attributes may be included, and if any
are displayed,
they must be displayed in the same order as they appear in in the
packet.

@comment **************************************************************
@node Service-Type
@subsection @attr{Service-Type}
@atindex Service-Type

@defattr{Service-Type,6,integer,LR,-R,LR,Replace,Yes}

@smallexample
VALUE      Service-Type      Login-User           1       
VALUE      Service-Type      Framed-User          2       
VALUE      Service-Type      Callback-Login-User  3       
VALUE      Service-Type      Callback-Framed-User 4       
VALUE      Service-Type      Outbound-User        5       
VALUE      Service-Type      Administrative-User  6       
VALUE      Service-Type      NAS-Prompt-User      7       
VALUE      Service-Type      Authenticate-Only    8       
VALUE      Service-Type      Call-Check           10      
@end smallexample

This attribute indicates the type of service the user has
requested, or the type of service to be provided.  It may be used
in both Access-Request and Access-Accept packets.

When used in an Access-Request the service type represents a
hint to the Radius server that the @NAS{} has reason to believe the user
would prefer the kind of service indicated.

When used in an Access-Accept, the service type is an indication
to the @NAS{} that the user must be provided this type of service.

The meaning of various service types is as follows:

@table @code
@item Login-User
The user should be connected to a host.

@item Framed-User
A framed protocol, such as PPP or SLIP, should be started for the user.
The @attr{Framed-IP-Address} attribute (@pxref{Framed-IP-Address}) will
supply the IP to be used.

@item Callback-Login-User
The user should be disconnected and called back, then connected to a host.

@item Callback-Framed-User
The user should be disconnected and called back; then a framed
protocol, such as PPP or SLIP,
should be started for the user.

@item Outbound-User
The user should be granted access to outgoing devices.

@item Administrative-User
The user should be granted access to the administrative interface
to the @NAS{}, from which privileged commands can be executed.

@item NAS-Prompt
The user should be provided a command prompt on the @NAS{}, from which
nonprivileged commands can be executed.

@item Authenticate-Only
Only authentication is requested, and no authorization information needs
to be returned in the Access-Accept.

@item Call-Check
@itemx Callback-NAS-Prompt
The user should be disconnected and called back, then provided a command
prompt on the @NAS{}, from which nonprivileged commands can be executed.
@end table

@comment **************************************************************
@node Session-Timeout
@subsection @attr{Session-Timeout}
@atindex Session-Timeout

@defattr{Session-Timeout,27,integer,-R,--,--,Replace,Yes}

This attribute sets the maximum number of seconds of service to be
provided to the user before termination of the session or prompt.
The server may send this attribute to the client in an Access-Accept
or Access-Challenge.

@comment **************************************************************
@node State
@subsection @attr{State}
@atindex State

@defattr{State,24,string,LR,LR,LR,Append,No}

This attribute is available to be sent by the server to the client
in an Access-Challenge and @strong{must} be sent unmodified from the client
to the server in the new Access-Request reply to that challenge,
if any.

This attribute is available to be sent by the server to the client
in an Access-Accept that also includes a @attr{Termination-Action}
attribute with the value @code{RADIUS-Request}.  If the @NAS{} performs
the termination action by sending a new Access-Request upon
termination of the current session, it @strong{must} include the @attr{State}
attribute unchanged in that Access-Request.

In either usage, no interpretation by the client should be made.
A packet may have only one @attr{State} attribute.

@comment **************************************************************
@node Termination-Action
@subsection @attr{Termination-Action}
@atindex Termination-Action

@defattr{Termination-Action,29,integer,LR,-R,-R,Replace,No}

@smallexample
VALUE      Termination-Action  Default              0       
VALUE      Termination-Action  RADIUS-Request       1       
@end smallexample

This attribute indicates what action the @NAS{} should take when the
specified service is completed.  It is only used in Access-Accept
packets.

@comment **************************************************************
@node User-Name
@subsection @attr{User-Name}
@atindex User-Name

@defattr{User-Name,1,string,LR,-R,LR,Replace,Yes}

This attribute indicates the name of the user to be authenticated or
accounted. It is used in Access-Request and Accounting attributes. 
The length of the user name is usually limited by some arbitrary value.
By default, Radius supports user names up to 32 characters long. This
value can be modified by redefining the @code{RUT_USERNAME} macro in the
@file{include/radutmp.h} file in the distribution directory and recompiling the
program.

Some @NAS{}es have peculiarities about sending long user names. For
example, the
Specialix Jetstream 8500 24-port access server inserts a @samp{/}
character after the 10th character if the user name is longer than
10 characters. In such cases, we recommend applying rewrite functions
in order to bring the user name to its normal form (@pxref{rewrite file}).


@comment **************************************************************
@node User-Password
@subsection @attr{User-Password}
@atindex User-Password

@defattr{User-Password,2,string,L-,--,--,@acronym{N/A},No}

This attribute indicates the password of the user to be
authenticated, or the user's input following an Access-Challenge.
It is only used in Access-Request packets.

On transmission, the password is hidden.  The password is first
padded at the end with nulls to a multiple of 16 octets.  A one-way
 MD5 hash is calculated over a stream of octets consisting of
the shared secret followed by the request authenticator.  This
value is @sc{xor}ed with the first 16 octet segment of the password and
placed in the first 16 octets of the String field of the User-Password
attribute.

If the password is longer than 16 characters, a second one-way MD5
hash is calculated over a stream of octets consisting of the
shared secret followed by the result of the first xor.  That hash
is @sc{xor}ed with the second 16 octet segment of the password and
placed in the second 16 octets of the string field of the 
User-Password attribute.

If necessary, this operation is repeated, with each @sc{xor} result
being used along with the shared secret to generate the next hash
to @sc{xor} the next segment of the password, up  to no more than 128
characters.

@comment **************************************************************
@node Vendor-Specific
@subsection @attr{Vendor-Specific}
@atindex Vendor-Specific
@UNREVISED{}

@defattr{Vendor-Specific,26,string,LR,-R,-R,Append,No}

This attribute is available to allow vendors to support their own
extended attributes not suitable for general usage. @FIXME{some more detail over the VSAs? How does GNU Radius handle unknown VSAs?}

@comment **************************************************************
@node Accounting Attributes
@section Accounting Attributes

These are attributes the @NAS{} sends along with accounting requests.
These attributes can not be used in matching rules.

@menu
* Acct-Authentic::
* Acct-Delay-Time::
* Acct-Input-Octets::
* Acct-Input-Packets::
* Acct-Output-Octets::
* Acct-Output-Packets::
* Acct-Session-Id::
* Acct-Session-Time::
* Acct-Status-Type:: 
* Acct-Terminate-Cause::
@end menu

@comment **************************************************************
@node Acct-Authentic
@subsection @attr{Acct-Authentic}
@atindex Acct-Authentic

@defattr{Acct-Authentic,45,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

@smallexample
VALUE           Acct-Authentic          RADIUS          1
VALUE           Acct-Authentic          Local           2
VALUE           Acct-Authentic          Remote          3
@end smallexample

This attribute may be included in an Accounting-Request to
indicate how the user was authenticated, whether by Radius, the
@NAS{} itself, or another remote authentication protocol.  Users who
are delivered service without being authenticated should not
generate accounting records.

@comment **************************************************************
@node Acct-Delay-Time
@subsection @attr{Acct-Delay-Time}
@atindex Acct-Delay-Time

@defattr{Acct-Delay-Time,41,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

This attribute indicates how many seconds the client has been
trying to send this record for, and can be subtracted from the
time of arrival on the server to find the approximate time of the
event generating this Accounting-Request.  (Network transit time
is ignored.)

@comment **************************************************************
@node Acct-Input-Octets
@subsection @attr{Acct-Input-Octets}
@atindex Acct-Input-Octets

@defattr{Acct-Input-Octets,42,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

This attribute indicates how many octets have been received from
the port over the course of this service being provided, and can
only be present in Accounting-Request records where
@code{Acct-Status-Type} is set to @code{Stop}.

@comment **************************************************************
@node Acct-Input-Packets
@subsection @attr{Acct-Input-Packets}
@atindex Acct-Input-Packets

@defattr{Acct-Input-Packets,47,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

This attribute indicates how many packets have been received from
the port over the course of this service being provided to a
framed user, and can only be present in Accounting-Request records
where @code{Acct-Status-Type} is set to @code{Stop}.

@comment **************************************************************
@node Acct-Output-Octets
@subsection @attr{Acct-Output-Octets}
@atindex Acct-Output-Octets

@defattr{Acct-Output-Octets,43,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

This attribute indicates how many octets have been sent to the
port in the course of delivering this service, and can only be
present in Accounting-Request records where @code{Acct-Status-Type}
is set to @code{Stop}.

@comment **************************************************************
@node Acct-Output-Packets
@subsection @attr{Acct-Output-Packets}
@atindex Acct-Output-Packets

@defattr{Acct-Output-Packets,48,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

This attribute indicates how many packets have been sent to the
port in the course of delivering this service to a framed user,
and can only be present in Accounting-Request records where
@code{Acct-Status-Type} is set to @code{Stop}.

@comment **************************************************************
@node Acct-Session-Id
@subsection @attr{Acct-Session-Id}
@atindex Acct-Session-Id

@defattr{Acct-Session-Id,44,string,--,--,--,@acronym{N/A},@acronym{N/A}}

This attribute is a unique accounting @sc{id} to make it easy to match
start and stop records in a log file.  The start and stop records
for a given session must have the same @code{Acct-Session-Id}.  An
Accounting-Request packet must have an @code{Acct-Session-Id}.  An
Access-Request packet may have an @code{Acct-Session-Id}; if it does,
then the @NAS{} must use the same @code{Acct-Session-Id} in the
Accounting-Request
packets for that session.

@comment **************************************************************
@node Acct-Session-Time
@subsection @attr{Acct-Session-Time}
@atindex Acct-Session-Time

@defattr{Acct-Session-Time,46,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

This attribute indicates how many seconds the user has received
service for, and can only be present in Accounting-Request records
where @code{Acct-Status-Type} is set to @code{Stop}.

@comment **************************************************************
@node Acct-Status-Type
@subsection @attr{Acct-Status-Type}
@atindex Acct-Status-Type

@defattr{Acct-Status-Type,40,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

@smallexample
VALUE    Acct-Status-Type    Start              1
VALUE    Acct-Status-Type    Stop               2 
VALUE    Acct-Status-Type    Alive              3
VALUE    Acct-Status-Type    Accounting-On      7
VALUE    Acct-Status-Type    Accounting-Off     8
@end smallexample

This attribute indicates whether this Accounting-Request marks the
beginning of the user service (@code{Start}) or the end (@code{Stop}).

It may also be used to mark the start of accounting (for example,
upon booting) by specifying @code{Accounting-On} and to mark the end of
accounting (for example, just before a scheduled reboot) by specifying
@code{Accounting-Off}.

A special value @code{Alive} or @code{Interim-Update} indicates the packet that
contains some additional data to the initial @code{Start} record or to the
last @code{Alive} record.

@comment **************************************************************
@node Acct-Terminate-Cause
@subsection @attr{Acct-Terminate-Cause}
@atindex Acct-Terminate-Cause

@defattr{Acct-Terminate-Cause,49,integer,--,--,--,@acronym{N/A},@acronym{N/A}}

@smallexample
VALUE    Acct-Terminate-Cause    User-Request            1
VALUE    Acct-Terminate-Cause    Lost-Carrier            2
VALUE    Acct-Terminate-Cause    Lost-Service            3
VALUE    Acct-Terminate-Cause    Idle-Timeout            4
VALUE    Acct-Terminate-Cause    Session-Timeout         5
VALUE    Acct-Terminate-Cause    Admin-Reset             6
VALUE    Acct-Terminate-Cause    Admin-Reboot            7
VALUE    Acct-Terminate-Cause    Port-Error              8
VALUE    Acct-Terminate-Cause    NAS-Error               9
VALUE    Acct-Terminate-Cause    NAS-Request             10
VALUE    Acct-Terminate-Cause    NAS-Reboot              11
VALUE    Acct-Terminate-Cause    Port-Unneeded           12
VALUE    Acct-Terminate-Cause    Port-Preempted          13
VALUE    Acct-Terminate-Cause    Port-Suspended          14
VALUE    Acct-Terminate-Cause    Service-Unavailable     15
VALUE    Acct-Terminate-Cause    Callback                16
VALUE    Acct-Terminate-Cause    User-Error              17
VALUE    Acct-Terminate-Cause    Host-Request            18
@end smallexample

This attribute indicates how the session was terminated, and can
only be present in Accounting-Request records where
@code{Acct-Status-Type} is set to @code{Stop}.

@comment **************************************************************
@node Radius Internal Attributes
@section Radius Internal Attributes

These are attributes used by GNU Radius during the processing
of a request. They are never returned to the @NAS{}. Mostly, they are
used in matching rules.

@menu
* Acct-Ext-Program::
* Acct-Type::
* Auth-Data::
* Auth-Failure-Trigger::
* Auth-Type::
* Crypt-Password::
* Exec-Program-Wait::
* Exec-Program::
* Fall-Through::
* Group::
* Hint::
* Huntgroup-Name::
* Log-Mode-Mask::
* Login-Time::
* Match-Profile::
* Menu::
* Pam-Auth::
* Prefix::
* Proxy-Replied::
* Realm-Name::
* Replace-User-Name::
* Rewrite-Function::
* Scheme-Acct-Procedure::
* Scheme-Procedure::
* Simultaneous-Use::
* Strip-User-Name::
* Suffix::
* Termination-Menu::
@end menu

@comment **************************************************************
@node Acct-Ext-Program
@subsection @attr{Acct-Ext-Program}
@atindex Acct-Ext-Program

@defattr{Acct-Ext-Program,2008,string,--,-R,--,Replace,@acronym{N/A}}

The @attr{Acct-Ext-Program} attribute can be used in @RHS{} of an
@file{raddb/hints} to require the execution of an external accounting
program or filter. If the attribute value starts with a vertical bar
(@samp{|}), then the attribute specifies the filter program to be used.
If it starts with a slash (@samp{/}), then it is understood as
the full pathname and arguments for the external program to be executed.
Using any other character as the start of this string results in error.

The command line can reference any attributes from both check and reply
pairlists using attribute macros (@pxref{Macro Substitution}).

Before the execution of the program, @command{radiusd} switches to the
uid and gid of the user @code{daemon} and the group @code{daemon}. You can
override these defaults by setting variables @code{exec-program-user}
and @code{exec-program-group} in configuration file to proper values
(@pxref{option,, The option statement}).

The accounting program must exit with status 0 to indicate a successful
accounting.

@node Acct-Type
@subsection @attr{Acct-Type}
@atindex Acct-Type

@defattr{Acct-Type,2003,integer,L-,-R,-R,Append,@acronym{N/A}}

@smallexample
VALUE           Acct-Type               None    0
VALUE           Acct-Type               System  1
VALUE           Acct-Type               Detail  2
VALUE           Acct-Type               SQL     3
@end smallexample

The @attr{Acct-Type} allows one to control which accounting methods
must be used for a given user or group of users. In the absence
of this attribute, all currently enabled accounting types are used.
@xref{Accounting}, for more information about accounting types.

@comment **************************************************************
@node Auth-Failure-Trigger
@subsection @attr{Auth-Failure-Trigger}
@atindex Auth-Failure-Trigger

This attribute specifies an external program or a Scheme expression to
be run upon an authentication failure. The handling of this attribute
depends upon its value:

If the value of @attr{Auth-Failure-Trigger} begins with @samp{/}, it
is taken to contain a command line for invoking an external
program. In this case @command{radiusd} invokes the program much the
same way it does when handling @attr{Exec-Program} attribute, i.e. the
program is invoked with standard input closed, its standard output and
standard error are captured and redirected to
@file{@var{radlog}/radius.stderr} file, the return value of the
program is ignored.

If the value of @attr{Auth-Failure-Trigger} begins with @samp{(}, it
is executed it as a @code{Scheme} expression. The return value of the
expression is ignored.

This attribute is designed as a means to provide special handling for
authentication failures. It can be used, for example, to increase
failure counters and to block accounts after a specified number of
authentication failures occurs. @xref{Auth Probing}, for the detailed
discussion of its usage.

@FIXME{There is no corresponding @attr{Auth-Success-Trigger}...
@attr{Exec-Program} or @attr{Scheme-Procedure} may be used for the
purpose, the latter, however, is not able to execute @emph{s-exps}. At
the time of this writing the release 1.3 is being prepared, so I do
not want to introduce any possibly destabilizing changes. This will be
fixed in future releases.}

@comment **************************************************************
@node Auth-Data
@subsection @attr{Auth-Data}
@atindex Auth-Data

@defattr{Auth-Data,2006,string,L-,-R,-R,Replace,@acronym{N/A}}

The @attr{Auth-Data} can be used to pass additional data to the
authentication methods that need them. In version @value{VERSION}
of GNU Radius, this attribute may be used in conjunction with the
@code{SQL} and @code{Pam} authentication types. When used with the
@code{Pam} authentication type, this attribute holds the name
of the PAM service to use. This attribute is temporarily
appended to the authentication request, so its value can be
referenced to as @code{%C@{Auth-Data@}}. 
@xref{Authentication Server Parameters}, for an example of
of using the @attr{Auth-Data} attribute in @file{raddb/sqlserver}:

@comment **************************************************************
@node Auth-Type
@subsection @attr{Auth-Type}
@atindex Auth-Type

@defattr{Auth-Type,1000,integer,L-,-R,-R,Append,No}

@smallexample
VALUE      Auth-Type         Local                0       
VALUE      Auth-Type         System               1       
VALUE      Auth-Type         Crypt-Local          3       
VALUE      Auth-Type         Reject               4       
VALUE      Auth-Type         SQL                  252     
VALUE      Auth-Type         Pam                  253     
VALUE      Auth-Type         Accept               254     
@end smallexample

This attribute tells the server which type of authentication
to apply to a particular user. It can be used in the @LHS{} of
the user's profile (@pxref{Authentication}.)

Radius interprets values of @attr{Auth-Type} attribute as follows:

@table @code
@item Local
The value of the @attr{User-Password} attribute from the record is taken
as a cleantext password and is compared against the @attr{User-Password} value
from the input packet. 

@item System
This means that a user's password is stored in a system password type.
Radius queries the operating system to determine if the user name and password
supplied in the incoming packet are O.K.

@item Crypt-Local
The value of the @attr{User-Password} attribute from the record is taken
as an MD5 hash on the user's password. Radius generates MD5 hash
on the supplied @attr{User-Password} value and compares the two strings.

@item Reject
Authentication fails.

@item Accept
Authentication succeeds.

@item SQL
@itemx Mysql
The MD5-encrypted user's password is queried from the @sc{sql} database
(@ref{SQL Auth}). @code{Mysql} is an alias maintained for compatibility
with other versions of Radius.

@item Pam
The user-name--password combination is checked using PAM.

@end table

@comment **************************************************************
@node Crypt-Password
@subsection @attr{Crypt-Password}
@atindex Crypt-Password

@defattr{Crypt-Password,1006,string,L-,--,--,Append,No}

This attribute is intended to be used in user's profile @LHS{}.
It specifies the MD5 hash of the user's password. When this attribute
is present, @code{Auth-Type = Crypt-Local} is assumed. If both @attr{Auth-Type}
and @attr{Crypt-Password} are present, the value of @attr{Auth-Type} is
ignored.

@xref{Auth-Type}.

@comment **************************************************************
@node Exec-Program-Wait
@subsection @attr{Exec-Program-Wait}
@atindex Exec-Program-Wait

@defattr{Exec-Program-Wait,1039,string,-R,-R--,Replace,No}

When present in the @RHS{}, the @attr{Exec-Program-Wait} attribute specifies
the program to be executed when the entry matches. If the attribute
value string starts with vertical bar (@samp{|}), then the attribute
specifies the filter program to be used. If it starts with
slash (@samp{/}), then it is understood as the full
pathname and arguments for the external program to be executed. Using
any other character as the start of this string results in error.

@menu
* Running External Program::
* Using External Filter::
@end menu

@comment **************************************************************
@node Running External Program
@subsubsection Running an External Program

The command line can reference any attributes from both check and reply
pairlists using attribute macros @pxref{Macro Substitution}.

Before the execution of the program, @command{radiusd} switches to
uid and gid of the user @code{daemon} and the group @code{daemon}. You can
override these defaults by setting the variable @code{exec-program-user}
in the configuration file to a proper value.
@xref{option,, The option statement}.

The daemon will wait until the program terminates. The return value
of its execution determines whether the entry matches. If the program
exits with a nonzero code, then the match fails. If it exits with a
zero code, the match succeeds. In this case the standard output of the
program is read and parsed as if it were a pairlist. The attributes
thus obtained are added to the entry's reply attributes.

@subheading Example.

Suppose the @file{users} file contains the following entry:

@smallexample
DEFAULT Auth-Type = System,
                Simultaneous-Use = 1
        Exec-Program-Wait = "/usr/local/sbin/telauth \
                             %C@{User-Name@} \
                             %C@{Calling-Station-Id@}"
@end smallexample

@noindent
Then, upon successful matching, the program
@file{/usr/local/sbin/telauth} will be executed. It will get as its
arguments the values of the @attr{User-Name} and @attr{Calling-Station-Id}
attributes from the request pairs.

The @file{/usr/local/sbin/telauth} can, for example, contain the
following:

@smallexample
#! /bin/sh

DB=/var/db/userlist

if grep "$1:$2" $DB; then
    echo "Service-Type = Login,"
    echo "Session-Timeout = 1200"
    exit 0
else
    echo "Reply-Message = \
          \"You are not authorized to log in\""
    exit 1
fi
@end smallexample

@noindent
It is assumed that @file{/var/db/userlist} contains a list of
@code{username}:@code{caller-id} pairs for those users that are
authorized to use login service.

@comment **************************************************************
@node Using External Filter
@subsubsection Using an External Filter

If the value of @attr{Exec-Program-Wait} attribute begins with @samp{|},
@command{radiusd} strips this character from the value and uses the
resulting string
as a name of the predefined external filter. Such filter must be
declared in @file{raddb/config} (@pxref{filters}).

@subheading Example.
Let the @file{users} file contain the following entry:

@smallexample
DEFAULT Auth-Type = System,
                Simultaneous-Use = 1
        Exec-Program-Wait = "|myfilter"
@end smallexample

@noindent
and let the @file{raddb/config} contain the following 
@footnote{In this example the @code{input-format} statement has been
split on two lines to fit the page width. It must occupy a @emph{single line}
in the real configuration file.}:

@smallexample
filters @{
    filter myfilter @{
        exec-path "/usr/libexec/myfilter";
        error-log "myfilter.log";
        auth @{
            input-format "%C@{User-Name@}
                          %C@{Calling-Station-Id@}";
            wait-reply yes;
        @};
    @};        
@};                        
@end smallexample
@noindent
Then, upon successful authentication, the program
@command{/usr/libexec/myfilter} will be invoked, if it hasn't already been
started for this thread. Any output it sends to its standard error
will be redirected to the file @file{myfilter.log} in the current
logging directory. A string consisting of the user's login name and
his calling station @sc{id} followed by a newline will be sent to the
program. 

The following is a sample @command{/usr/libexec/myfilter} written
in the shell:

@smallexample
#! /bin/sh

DB=/var/db/userlist

while read NAME CLID
do
    if grep "$1:$2" $DB; then
        echo "0 Service-Type = Login, Session-Timeout = 1200"
    else
        echo "1 Reply-Message = \
              \"You are not authorized to log in\""
    fi
done
@end smallexample

@comment **************************************************************
@node Exec-Program
@subsection @attr{Exec-Program}
@atindex Exec-Program

@defattr{Exec-Program,1038,string,-R,--,--,Replace,No}

When present in the @RHS{}, the @attr{Exec-Program} attribute specifies
the full pathname and arguments for the program to be executed when the
entry matches.

The command line can reference any attributes from both check and reply
pairlists, using attribute macros (@pxref{Macro Substitution}).

Before the execution of the program, @command{radiusd} switches to the
uid and gid of the user @code{daemon} and the group @code{daemon}. You can
override these defaults by setting variables @code{exec-program-user}
and @code{exec-program-group} in configuration file to proper values
@ref{option,, The option statement}.

The daemon does not wait for the process to terminate.

@subheading Example

Suppose the @file{users} file contains the following entry:

@smallexample
DEFAULT Auth-Type = System,
                Simultaneous-Use = 1
        Exec-Program = "/usr/local/sbin/logauth \
                        %C@{User-Name@} \
                        %C@{Calling-Station-Id@}"
@end smallexample

@noindent
Then, upon successful matching, the program
@file{/usr/local/sbin/logauth} will be executed. It will get as its
arguments the values of the @attr{User-Name} and @attr{Calling-Station-Id}
attributes from the request pairs.

@comment **************************************************************
@node Fall-Through
@subsection @attr{Fall-Through}
@atindex Fall-Through

@defattr{Fall-Through,1036,integer,LR,LR,--,Append,No}

@smallexample
VALUE      Fall-Through      No                   0       
VALUE      Fall-Through      Yes                  1       
@end smallexample

The @attr{Fall-Through} attribute should be used in the reply list.
If its value is set to @code{Yes} in a particular record, that
tells Radius to continue looking up other records
even when the record at hand matches the request. It can be used to provide
default values for several profiles.

Consider the following example. Let's suppose the @file{users} file
contains the following:

@smallexample

johns   Auth-Type = SQL
                Framed-IP-Address = 11.10.10.251,
                Fall-Through = Yes

smith   Auth-Type = SQL
                Framed-IP-Address = 11.10.10.252,
                Fall-Through = Yes

DEFAULT NAS-IP-Address = 11.10.10.1
        Service-Type = Framed-User,
                Framed-Protocol = PPP

@end smallexample

@noindent
Then after successful matching of a particular user's record,
the matching will continue until it finds the @code{DEFAULT} entry,
which will add its @RHS{} to the reply pairs for
this request. The effect is that, if user @samp{johns} authenticates
successfully she gets the following reply pairs:

@smallexample
        Service-Type = Framed-User,
        Framed-Protocol = PPP,  
        Framed-IP-Address = 11.10.10.251
@end smallexample

@noindent
whereas user @code{smith} gets

@smallexample
        Service-Type = Framed-User,
        Framed-Protocol = PPP,  
        Framed-IP-Address = 11.10.10.252
@end smallexample

@noindent
Note that the attribute @attr{Fall-Through} itself
is never returned to the @NAS{}.

@comment **************************************************************
@node Group
@subsection @attr{Group}
@atindex Group

@defattr{Group,1005,string,L-,L-,LR,Append,No}

@comment **************************************************************
@node Hint
@subsection @attr{Hint}
@atindex Hint

@defattr{Hint,1040,string,L-,-R,-R,Append,No}

Use the @attr{Hint} attribute to specify additional matching criteria
depending on the hint (@pxref{hints file}).

Let the @file{hints} file contain

@smallexample
DEFAULT         Prefix = "S", Strip-User-Name = No
                Hint = "SLIP"
@end smallexample

@noindent
and the @file{users} file contain

@smallexample
DEFAULT Hint = "SLIP",
                NAS-IP-Address = 11.10.10.12,
                Auth-Type = System
        Service-Type = Framed-User,
                Framed-Protocol = SLIP
@end smallexample

@noindent

Then any user having a valid system account and coming from @NAS{}
@samp{11.10.10.12} will be provided SLIP service if his user name
starts with @samp{S}.
                
@comment **************************************************************
@node Huntgroup-Name
@subsection @attr{Huntgroup-Name}
@atindex Huntgroup-Name

@defattr{Huntgroup-Name,221,string,L-,-R,LR,Append,No}

The @attr{Huntgroup-Name} can be used either in the @LHS{} of the
@file{users} file record or in the @RHS{} of the @file{huntgroups}
file record.

When encountered in a @LHS{} of a particular @file{users} profile,
this attribute indicates the huntgroup name to be matched. Radius looks
up the corresponding record in the @file{huntgroups} file. If such a
record is found, each @AVP{} from its reply list is compared against
the corresponding pair from the request being processed. The request
matches only if it contains all the attributes from the specified
huntgroup, and their values satisfy the conditions listed in the
huntgroup pairs.

For example, suppose that the authentication request contains the
following attributes:

@smallexample
User-Name = "john",
User-Password = "guess",
NAS-IP-Address = 10.11.11.1,
NAS-Port-Id = 24
@end smallexample

@noindent
Let us further suppose that the @file{users} file contains the following
entry:

@smallexample
john    Huntgroup-Name = "users_group",
                Auth-Type = System
        Service-Type = Login
@end smallexample

@noindent
and, finally, @file{huntgroups} contains the following entry:

@smallexample
users_group     NAS-IP-Address = 10.11.11.1
                NAS-Port-Id < 32
@end smallexample

@noindent
Then the authentication request will succeed, since it contains
@attr{NAS-Port-Id} attribute and its value is less than 32.

@xref{huntgroups file}.

@node Log-Mode-Mask
@subsection @attr{Log-Mode-Mask}
@atindex Log-Mode-Mask

@defattr{Log-Mode-Mask,2007,integer,L-,-R,-R,Append,@acronym{N/A}}

@smallexample
VALUE           Log-Mode-Mask           Log-Auth                1
VALUE           Log-Mode-Mask           Log-Auth-Pass           2
VALUE           Log-Mode-Mask           Log-Failed-Pass         4
VALUE           Log-Mode-Mask           Log-Pass                6
VALUE           Log-Mode-Mask           Log-All                 7
@end smallexample

@attr{Log-Mode-Mask} is used to control the verbosity of authentication
log messages for given user or class of users. The meaning of its
values is:

@table @code
@item Log-Auth
Do not log successful authentications.
@item Log-Auth-Pass
Do not show the password with the log message from a successful authentication.
@item Log-Failed-Pass
Do not show a failed password.
@item Log-Pass
Do not show a plaintext password, either failed or succeeded.
@item Log-All
Do not log authentications at all.
@end table

Technical details: After authentication, the server collects all
@attr{Log-Mode-Mask} attributes from the incoming request and @LHS{}
of the user's entry. The values of these attributes @sc{or}ed together
form a mask, which is applied via an @sc{xor} operation to the current log
mode. The value thus obtained is used as effective log mode.

@comment **************************************************************
@node Login-Time
@subsection @attr{Login-Time}
@atindex Login-Time

@defattr{Login-Time,1042,string,L-,--,--,Append,No}

The @attr{Login-Time} attribute specifies the time range over which the user
is allowed to log in. The attribute should be specified in the @LHS{}.

The format of the @attr{Login-Time} string is the same as that of UUCP
time ranges. The following description of the time range format is
adopted from the documentation for the Taylor UUCP package:

A time string may be a list of simple time strings separated with
vertical bars @samp{|} or commas @samp{,}.

Each simple time string must begin either with a day-of-week abbreviation
(one of @samp{Su}, @samp{Mo}, @samp{Tu}, @samp{We}, @samp{Th},
@samp{Fr}, @samp{Sa}), or @samp{Wk} for any day from Monday to
Friday inclusive, or @samp{Any} or @samp{Al} for any day.

Following the day may be a range of hours separated with a hyphen, using
24-hour time.  The range of hours may cross 0; for example
@samp{2300-0700} means any time except 7 AM to 11 PM.  If no time is
given, calls may be made at any time on the specified day(s).  

The time string may also be the single word @samp{Never}, which does not
match any time.

Here are a few sample time strings with an explanation of what they
mean.

@table @samp

@item Wk2305-0855,Sa,Su2305-1655

This means weekdays before 8:55 AM or after 11:05 PM, any time Saturday,
or Sunday before 4:55 PM or after 11:05 PM.  These are approximately the
times during which night rates apply to phone calls in the U.S.A.  Note
that this time string uses, for example, @samp{2305} rather than
@samp{2300}; this will ensure a cheap rate even if the
computer clock is running up to five minutes ahead of the real time.

@item Wk0905-2255,Su1705-2255

This means weekdays from 9:05 AM to 10:55 PM, or Sunday from 5:05 PM to
10:55 PM.  This is approximately the opposite of the previous example.

@item Any

This means any day.  Since no time is specified, it means any time on
any day.

@end table

@comment **************************************************************
@node Match-Profile
@subsection @attr{Match-Profile}
@atindex Match-Profile

@defattr{Match-Profile,2004,string,LR,-R,-R,Append,No}

The @attr{Match-Profile} attribute can be used in @LHS{} and @RHS{} lists of a
user profile. Its value is the name of another user's profile (target
profile). When @attr{Match-Profile} is used in the @LHS{}, the incoming
packet will match this profile only if it matches the target profile.
In this case the reply pairs will be formed by concatenating the @RHS{}
lists from both profiles.
When used in the @RHS{}, this attribute causes the reply pairs
from the target profile to be appended to the reply from the current
profile if the target profile matches the incoming request.

For example:

@smallexample
IPPOOL  NAS-IP-Address = 10.10.10.1
                Framed-Protocol = PPP,
                Framed-IP-Address = "10.10.10.2"

IPPOOL  NAS-IP-Address = 10.10.11.1
                Framed-Protocol = PPP,
                Framed-IP-Address = "10.10.11.2"

guest   Auth-Type = SQL
                Service-Type = Framed-User,
        Match-Profile = IPPOOL
@end smallexample

In this example, when user @code{guest} comes from @NAS{}
@code{10.10.10.1}, he is
assigned IP @code{10.10.10.2}, otherwise if he is coming from @NAS{}
@code{10.10.11.1} he is assigned IP @code{10.10.11.2}.
                
@comment **************************************************************
@node Menu
@subsection @attr{Menu}
@atindex Menu

@defattr{Menu,1001,string,-R,--,--,Replace,No}

This attribute should be used in the @RHS{}. If it is used, it should
be the only reply item.

The @attr{Menu} attribute specifies the name of the menu to be presented
to the user. The corresponding menu code is looked up in the
@file{RADIUS_DIR/menus/} directory (@pxref{menus directory}).

@comment **************************************************************
@node Pam-Auth
@subsection @attr{Pam-Auth}
@atindex Pam-Auth

@defattr{Pam-Auth,1041,string,L-,-R,-R,Append,No}

The @attr{Pam-Auth} attribute can be used in conjunction with

@smallexample
Auth-Type = Pam
@end smallexample

@noindent
to supply the PAM service name instead of the default @samp{radius}.
It is ignored if @attr{Auth-Type} attribute is not set to @code{Pam}.

@comment **************************************************************
@node Prefix
@subsection @attr{Prefix}
@atindex Prefix

@defattr{Prefix,1003,string,L-,L-,LR,Append,No}

The @attr{Prefix} attribute indicates the prefix that the user name
should contain in order for a particular record in the profile
to be matched. This attribute should be specified in the @LHS{}
of the @file{users} or @file{hints} file.

For example, if the @file{users} file contained

@smallexample
DEFAULT Prefix = "U", Auth-Type = System
                Service-Type = Login-User
@end smallexample

@noindent
then the user names @samp{Ugray} and @samp{Uyoda} would match this record,
whereas @samp{gray} and @samp{yoda} would not.

Both @attr{Prefix} and @attr{Suffix} attributes may be specified in
a profile. In this case the record is matched only if the user name
contains both the prefix and the suffix specified.

@xref{Suffix}, and
@ref{Strip-User-Name}.

@comment **************************************************************
@node Proxy-Replied
@subsection @attr{Proxy-Replied}
@atindex Proxy-Replied

@defattr{Proxy-Replied,2012,integer,L-,L-,L-,Replace,@acronym{N/A}}

@smallexample
VALUE      Proxy-Replied     No                   0       
VALUE      Proxy-Replied     Yes                  1       
@end smallexample

@command{radiusd} adds this attribute to the incoming request if it
was already processed by a remote radius server.

@comment **************************************************************
@node Realm-Name
@subsection @attr{Realm-Name}
@atindex Realm-Name
@UNREVISED{}

@defattr{Realm-Name,2013,string,L-,L-,L-,Append,No}

@FIXME{This is an @samp{internal attribute}. It keeps the realm name
of the user. The @attr{Realm-Name} attribute is added to the proxied
request after receiving a reply from the realm server. @xref{Proxy-Replied}.}

@comment **************************************************************
@node Replace-User-Name
@subsection @attr{Replace-User-Name}
@atindex Replace-User-Name

@defattr{Replace-User-Name,2001,string,LR,LR,--,Append,No}

@smallexample
VALUE      Replace-User-Name  No                   0       
VALUE      Replace-User-Name  Yes                  1       
@end smallexample

Use this attribute to modify the user name from the incoming packet. The
@attr{Replace-User-Name} can reference any attributes from both @LHS{}
and @RHS{} pairlists using attribute macros (@ref{Macro Substitution}).

For example, the @file{users} entry

@smallexample
guest   NAS-IP-Address = 11.10.10.11,
                Calling-Station-Id != ""
                Auth-Type = Accept
        Replace-User-Name = "guest#%C@{Calling-Station-Id@}",
                Service-Type = Framed-User,
                Framed-Protocol = PPP
@end smallexample

@noindent
allows the use of PPP service for user name @code{guest}, coming from @NAS{}
@samp{11.10.10.11} with a nonempty @attr{Calling-Station-Id} attribute.
A string consisting of a @samp{#} character followed by the
@attr{Calling-Station-Id} value is appended to the user name.

@comment **************************************************************
@node Rewrite-Function
@subsection @attr{Rewrite-Function}
@atindex Rewrite-Function

@defattr{Rewrite-Function,2004,string,LR,LR,LR,Append,No}

The @attr{Rewrite-Function} attribute specifies the name of the
rewriting function to be applied to the request. The attribute
may be specified in either pairlist in the entries of
the @file{hints} or @file{huntgroups} configuration file.

The corresponding function should be defined in @file{rewrite} as

@smallexample
integer @var{name}()
@end smallexample

@noindent
i.e., it should return an integer value and should not take any arguments.

@xref{rewrite file,, Packet rewriting rules},
@ref{hints file};
@ref{huntgroups file}.

@node Scheme-Acct-Procedure
@subsection @attr{Scheme-Acct-Procedure}
@atindex Scheme-Acct-Procedure

@defattr{Scheme-Acct-Procedure,2010,string,--,-R,--,Replace,@acronym{N/A}} 

The @attr{Scheme-Acct-Procedure} attribute is used to set the name
of the Scheme accounting procedure. @xref{Accounting with Scheme}, for
information about how to write Scheme accounting procedures.

@comment **************************************************************
@node Scheme-Procedure
@subsection @attr{Scheme-Procedure}
@atindex Scheme-Procedure

@defattr{Scheme-Procedure,2009,string,-R,-R--,Append,@acronym{N/A}}

The @attr{Scheme-Procedure} attribute is used to set the name
of the Scheme authentication procedure. @xref{Authentication with Scheme}, for
information about how to write Scheme authentication procedures.

@comment **************************************************************
@node Simultaneous-Use
@subsection @attr{Simultaneous-Use}
@atindex Simultaneous-Use

@defattr{Simultaneous-Use,1034,integer,L-,-R,-R,Append,No}

This attribute specifies the maximum number of simultaneous logins
a given user is permitted to have. When the user is logged in this
number of times, any further attempts to log in are rejected.

@xref{Multiple Login Checking}.
 
@comment **************************************************************
@node Strip-User-Name
@subsection @attr{Strip-User-Name}
@atindex Strip-User-Name

@defattr{Strip-User-Name,1035,integer,LR,LR,-R,Append,No}

@smallexample
VALUE      Strip-User-Name   No                   0       
VALUE      Strip-User-Name   Yes                  1       
@end smallexample

The value of @attr{Strip-User-Name} indicates whether Radius should
strip any prefixes/suffixes specified in the user's profile from the
user name. When it is set to @code{Yes}, the user names will be logged and
accounted without any prefixes or suffixes.

A user may have several user names for different kind of services. In
this case differentiating the user names by their prefixes and stripping
them off before accounting would help keep accounting records
consistent.

For example, let's suppose the @file{users} file contains

@smallexample
DEFAULT Suffix = ".ppp",
                Strip-User-Name = Yes,
                Auth-Type = SQL
        Service-Type = Framed-User,
                Framed-Protocol = PPP

DEFAULT Suffix = ".slip",
                Strip-User-Name = Yes,
                Auth-Type = SQL
        Service-Type = Framed-User,
                Framed-Protocol = SLIP
@end smallexample

@noindent
Now, user @samp{johns}, having a valid account in the @sc{sql} database,
logs in as @samp{johns.ppp}. She then is provided the PPP service,
and her PPP session is accounted under user name @samp{johns}.
Later on, she logs in as @samp{johns.slip}. In this case she is
provided the SLIP service and again her session is accounted
under her real user name @samp{johns}.

@comment **************************************************************
@node Suffix
@subsection @attr{Suffix}
@atindex Suffix

@defattr{Suffix,1004,string,L-,L-,LR,Append,No}

The @attr{Suffix} attribute indicates the suffix that the user name
should contain in order for a particular record in the profile
to be matched. This attribute should be specified in @LHS{}
of the @file{users} or @file{hints} file.

For example, if the @file{users} file contained

@smallexample
DEFAULT Suffix = ".ppp", Auth-Type = System,
                Strip-User-Name = Yes
        Service-Type = Framed-User,
                Framed-Protocol = PPP        
@end smallexample

@noindent
then the user names @samp{gray.ppp} and @samp{yoda.ppp} would match this record,
whereas @samp{gray} and @samp{yoda} would not.

Both @attr{Prefix} and @attr{Suffix} attributes may be specified in
a profile. In this case the record is matched only if the user name
contains both the prefix and the suffix specified.

@xref{Prefix}, and
@ref{Strip-User-Name}.

@comment **************************************************************
@node Termination-Menu
@subsection @attr{Termination-Menu}
@atindex Termination-Menu

@defattr{Termination-Menu,1002,string,-R,--,--,Replace,No}

This attribute should be used in the @RHS{}. If it is used, it should
be the only reply item.

The @attr{Termination-Menu} specifies the name of the menu file to be
presented to the user after finishing his session. The corresponding
menu code is looked up in the @file{RADIUS_DIR/menus/} directory
(@pxref{menus directory}).











